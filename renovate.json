{
  "extends": ["config:best-practices"],
  "platformAutomerge": true,
  
  "prConcurrentLimit": 0,
  "branchConcurrentLimit": 0,
  "prHourlyLimit": 0,
  
  "automerge": true,
  "automergeType": "pr",
  "ignoreTests": false,
  
  "kubernetes": {
    "managerFilePatterns": [
      "/^api-gateway\\/infra\\/k8s\\/.+\\.ya?ml$/",
      "/^auth\\/infra\\/k8s\\/.+\\.ya?ml$/",
      "/^email\\/infra\\/k8s\\/.+\\.ya?ml$/",
      "/^ledger\\/infra\\/k8s\\/.+\\.ya?ml$/",
      "/^payments\\/infra\\/k8s\\/.+\\.ya?ml$/"
    ]
  },
  "packageRules": [
    {
      "description": "Automerge all Go module updates including majors",
      "matchManagers": ["gomod"],
      "automerge": true,
      "automergeType": "pr",
      "ignoreTests": false
    },
    {
      "description": "Automerge all Docker image updates including majors", 
      "matchManagers": ["dockerfile", "docker-compose"],
      "automerge": true,
      "automergeType": "pr",
      "ignoreTests": false
    },
    {
      "description": "Automerge digest-only updates for our k8s image refs",
      "matchManagers": [
        "kubernetes"
      ],
      "matchDatasources": [
        "docker"
      ],
      "matchPackageNames": [
        "andreistefanciprian/gomicropay-gateway",
        "andreistefanciprian/gomicropay-auth",
        "andreistefanciprian/gomicropay-email",
        "andreistefanciprian/gomicropay-ledger",
        "andreistefanciprian/gomicropay-payments"
      ],
      "matchFileNames": [
        "api-gateway/infra/k8s/**",
        "auth/infra/k8s/**",
        "email/infra/k8s/**",
        "ledger/infra/k8s/**",
        "payments/infra/k8s/**"
      ],
      "matchUpdateTypes": [
        "digest",
        "pinDigest"
      ],
      "groupName": "K8s image digests",
      "automerge": true,
      "automergeType": "pr",
      "ignoreTests": true
    },
    {
      "description": "Automerge all Kubernetes manifest updates including majors",
      "matchManagers": ["kubernetes"],
      "automerge": true, 
      "automergeType": "pr",
      "ignoreTests": false
    }
  ]
}
